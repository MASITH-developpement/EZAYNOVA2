<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire du wizard de cr√©ation de tunnel -->
    <record id="view_funnel_creation_wizard_form" model="ir.ui.view">
        <field name="name">funnel.creation.wizard.form</field>
        <field name="model">funnel.creation.wizard</field>
        <field name="arch" type="xml">
            <form string="Assistant de Cr√©ation de Tunnel de Vente">
                <header>
                    <field name="current_step" widget="statuses"
                           statusbar_visible="1_basic,2_landing,3_steps,4_fields,5_thank_you,6_preview"/>
                </header>

                <sheet>
                    <!-- ================================================ -->
                    <!-- √âTAPE 1: INFORMATIONS DE BASE -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '1_basic'">
                        <group colspan="2">
                            <h1>‚ú® Cr√©ez votre tunnel de vente avec l'IA</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                Laissez l'intelligence artificielle vous guider dans la cr√©ation
                                d'un tunnel de vente optimis√© pour la conversion.
                            </p>
                        </group>

                        <!-- Template de d√©part -->
                        <group string="üéØ Template de d√©part (optionnel)" colspan="2">
                            <field name="template_id" placeholder="Choisir un template pr√©-configur√©"/>
                            <button name="action_apply_template"
                                    string="Appliquer le template"
                                    type="object"
                                    class="btn-primary"
                                    invisible="not template_id"
                                    icon="fa-magic"/>
                        </group>

                        <!-- Informations de base -->
                        <group string="üìù Informations de base" colspan="2">
                            <field name="name"
                                   placeholder="Ex: T√©l√©chargez notre guide gratuit"
                                   required="1"/>
                            <field name="funnel_type"/>
                            <field name="target_goal"
                                   placeholder="Ex: Collecter 100 emails par mois"/>
                            <field name="target_audience"
                                   placeholder="Ex: Entrepreneurs, TPE/PME"/>
                        </group>

                        <!-- Description avec IA -->
                        <group string="üìÑ Description du tunnel" colspan="2">
                            <button name="action_generate_description"
                                    string="ü§ñ G√©n√©rer avec l'IA"
                                    type="object"
                                    class="btn-primary"
                                    icon="fa-magic"
                                    help="L'IA va cr√©er une description optimis√©e bas√©e sur vos informations"/>

                            <field name="use_ai_description"
                                   invisible="not ai_generated_description"
                                   string="Utiliser la description g√©n√©r√©e par IA"/>

                            <field name="ai_generated_description"
                                   invisible="not ai_generated_description"
                                   readonly="1"
                                   nolabel="1"/>

                            <field name="description"
                                   invisible="use_ai_description"
                                   placeholder="Ou saisissez votre propre description..."
                                   nolabel="1"/>
                        </group>
                    </group>

                    <!-- ================================================ -->
                    <!-- √âTAPE 2: PAGE D'ACCUEIL (LANDING PAGE) -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '2_landing'">
                        <group colspan="2">
                            <h1>üé® Cr√©ez votre page d'accueil</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                La page d'accueil est la premi√®re impression. Rendez-la m√©morable !
                            </p>
                        </group>

                        <!-- Configuration landing page -->
                        <group string="üñºÔ∏è En-t√™te de la page" colspan="2">
                            <field name="landing_title"
                                   placeholder="Ex: T√©l√©chargez notre guide gratuit"
                                   required="1"/>
                            <field name="landing_subtitle"
                                   placeholder="Ex: D√©couvrez les secrets de la croissance"/>
                            <field name="show_progress_bar"/>
                        </group>

                        <!-- Contenu avec IA -->
                        <group string="üìù Contenu de la page" colspan="2">
                            <button name="action_generate_landing_page"
                                    string="ü§ñ G√©n√©rer avec l'IA"
                                    type="object"
                                    class="btn-primary"
                                    icon="fa-magic"
                                    help="L'IA va cr√©er un contenu de landing page optimis√© pour la conversion"/>

                            <field name="use_ai_landing"
                                   invisible="not ai_generated_landing"
                                   string="Utiliser le contenu g√©n√©r√© par IA"/>

                            <field name="ai_generated_landing"
                                   invisible="not ai_generated_landing"
                                   readonly="1"
                                   nolabel="1"/>

                            <field name="landing_content"
                                   invisible="use_ai_landing"
                                   placeholder="Ou cr√©ez votre propre contenu HTML..."
                                   nolabel="1"/>
                        </group>
                    </group>

                    <!-- ================================================ -->
                    <!-- √âTAPE 3: √âTAPES DU TUNNEL -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '3_steps'">
                        <group colspan="2">
                            <h1>üéØ Configurez les √©tapes du tunnel</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                Divisez le parcours utilisateur en √©tapes logiques et progressives.
                            </p>
                        </group>

                        <!-- Nombre d'√©tapes -->
                        <group string="üìä Configuration des √©tapes" colspan="2">
                            <field name="step_count"
                                   help="Entre 1 et 5 √©tapes recommand√©es"/>

                            <button name="action_suggest_steps"
                                    string="ü§ñ Sugg√©rer des √©tapes avec l'IA"
                                    type="object"
                                    class="btn-primary"
                                    icon="fa-magic"
                                    help="L'IA va sugg√©rer des √©tapes pertinentes pour votre tunnel"/>

                            <field name="ai_suggested_steps"
                                   invisible="not ai_suggested_steps"
                                   readonly="1"
                                   nolabel="1"/>
                        </group>

                        <!-- Configuration d√©taill√©e des √©tapes -->
                        <group string="‚úèÔ∏è D√©tails des √©tapes" colspan="2">
                            <!-- √âtape 1 -->
                            <group colspan="2">
                                <label for="step_1_name" string="√âtape 1"/>
                                <field name="step_1_name" placeholder="Nom de l'√©tape 1" nolabel="1"/>
                                <field name="step_1_description"
                                       placeholder="Description de l'√©tape 1"
                                       nolabel="1"/>
                            </group>

                            <!-- √âtape 2 -->
                            <group colspan="2" invisible="step_count &lt; 2">
                                <label for="step_2_name" string="√âtape 2"/>
                                <field name="step_2_name" placeholder="Nom de l'√©tape 2" nolabel="1"/>
                                <field name="step_2_description"
                                       placeholder="Description de l'√©tape 2"
                                       nolabel="1"/>
                            </group>

                            <!-- √âtape 3 -->
                            <group colspan="2" invisible="step_count &lt; 3">
                                <label for="step_3_name" string="√âtape 3"/>
                                <field name="step_3_name" placeholder="Nom de l'√©tape 3" nolabel="1"/>
                                <field name="step_3_description"
                                       placeholder="Description de l'√©tape 3"
                                       nolabel="1"/>
                            </group>

                            <!-- √âtape 4 -->
                            <group colspan="2" invisible="step_count &lt; 4">
                                <label for="step_4_name" string="√âtape 4"/>
                                <field name="step_4_name" placeholder="Nom de l'√©tape 4" nolabel="1"/>
                                <field name="step_4_description"
                                       placeholder="Description de l'√©tape 4"
                                       nolabel="1"/>
                            </group>

                            <!-- √âtape 5 -->
                            <group colspan="2" invisible="step_count &lt; 5">
                                <label for="step_5_name" string="√âtape 5"/>
                                <field name="step_5_name" placeholder="Nom de l'√©tape 5" nolabel="1"/>
                                <field name="step_5_description"
                                       placeholder="Description de l'√©tape 5"
                                       nolabel="1"/>
                            </group>
                        </group>
                    </group>

                    <!-- ================================================ -->
                    <!-- √âTAPE 4: CHAMPS DU FORMULAIRE -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '4_fields'">
                        <group colspan="2">
                            <h1>üìã Configurez les champs du formulaire</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                S√©lectionnez les informations que vous souhaitez collecter.
                            </p>
                        </group>

                        <!-- Champs standards -->
                        <group string="‚úÖ Champs standards" colspan="2">
                            <field name="include_name"/>
                            <field name="include_email"/>
                            <field name="include_phone"/>
                            <field name="include_company"/>
                            <field name="include_message"/>
                        </group>

                        <!-- Champs personnalis√©s avec IA -->
                        <group string="üé® Champs personnalis√©s" colspan="2">
                            <button name="action_suggest_fields"
                                    string="ü§ñ Sugg√©rer des champs avec l'IA"
                                    type="object"
                                    class="btn-primary"
                                    icon="fa-magic"
                                    help="L'IA va sugg√©rer des champs pertinents pour votre tunnel"/>

                            <field name="ai_suggested_fields"
                                   invisible="not ai_suggested_fields"
                                   readonly="1"
                                   nolabel="1"/>

                            <field name="custom_fields"
                                   placeholder="Ajoutez vos propres champs (un par ligne)&#10;Ex:&#10;- Taille de l'entreprise&#10;- Budget disponible&#10;- Date de d√©but souhait√©e"
                                   nolabel="1"/>
                        </group>
                    </group>

                    <!-- ================================================ -->
                    <!-- √âTAPE 5: PAGE DE REMERCIEMENT -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '5_thank_you'">
                        <group colspan="2">
                            <h1>üéâ Page de remerciement</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                Terminez en beaut√© avec un message de remerciement engageant.
                            </p>
                        </group>

                        <!-- Configuration page de remerciement -->
                        <group string="üíå Message de remerciement" colspan="2">
                            <field name="thank_you_title" placeholder="Ex: Merci !"/>

                            <button name="action_generate_thank_you_message"
                                    string="ü§ñ G√©n√©rer avec l'IA"
                                    type="object"
                                    class="btn-primary"
                                    icon="fa-magic"
                                    help="L'IA va cr√©er un message de remerciement personnalis√©"/>

                            <field name="use_ai_thank_you"
                                   invisible="not ai_generated_thank_you"
                                   string="Utiliser le message g√©n√©r√© par IA"/>

                            <field name="ai_generated_thank_you"
                                   invisible="not ai_generated_thank_you"
                                   readonly="1"
                                   nolabel="1"/>

                            <field name="thank_you_message"
                                   invisible="use_ai_thank_you"
                                   placeholder="Ou cr√©ez votre propre message..."
                                   nolabel="1"/>
                        </group>

                        <!-- Redirection et actions -->
                        <group string="üîó Apr√®s la soumission" colspan="2">
                            <field name="redirect_url"
                                   placeholder="https://example.com/merci (optionnel)"/>
                        </group>

                        <!-- Actions automatiques -->
                        <group string="‚öôÔ∏è Actions automatiques" colspan="2">
                            <field name="create_lead"/>
                            <field name="create_contact"/>
                        </group>
                    </group>

                    <!-- ================================================ -->
                    <!-- √âTAPE 6: PR√âVISUALISATION -->
                    <!-- ================================================ -->
                    <group invisible="current_step != '6_preview'">
                        <group colspan="2">
                            <h1>üëÅÔ∏è Aper√ßu de votre tunnel</h1>
                            <p style="color: #6c757d; font-size: 14px;">
                                Voici √† quoi ressemblera votre tunnel de vente. Vous pourrez le personnaliser davantage apr√®s cr√©ation.
                            </p>
                        </group>

                        <!-- Aper√ßu HTML -->
                        <group colspan="2">
                            <field name="preview_html" nolabel="1"/>
                        </group>
                    </group>
                </sheet>

                <!-- Footer avec navigation -->
                <footer>
                    <!-- Bouton Pr√©c√©dent -->
                    <button name="action_previous_step"
                            string="‚Üê Pr√©c√©dent"
                            type="object"
                            class="btn-secondary"
                            invisible="current_step == '1_basic'"/>

                    <!-- Bouton Suivant -->
                    <button name="action_next_step"
                            string="Suivant ‚Üí"
                            type="object"
                            class="btn-primary"
                            invisible="current_step == '6_preview'"/>

                    <!-- Bouton Cr√©er (derni√®re √©tape) -->
                    <button name="action_create_funnel"
                            string="‚úÖ Cr√©er le tunnel"
                            type="object"
                            class="btn-success"
                            invisible="current_step != '6_preview'"/>

                    <!-- Bouton Annuler -->
                    <button string="Annuler"
                            class="btn-secondary"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action pour ouvrir le wizard -->
    <record id="action_funnel_creation_wizard" model="ir.actions.act_window">
        <field name="name">Cr√©er un Tunnel avec l'IA</field>
        <field name="res_model">funnel.creation.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_sales_funnel"/>
        <field name="binding_view_types">form,list</field>
    </record>
</odoo>
