<?xml version="1.0" encoding="utf-8"?>
<odoo noupdate="1">
    <!-- Règle de base -->
    <record id="intervention_company_rule" model="ir.rule">
        <field name="name">Règle multi-société interventions</field>
        <field name="model_id" ref="model_intervention_intervention"/>
        <field name="global" eval="True"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', '=', user.company_id.id)]</field>
    </record>

    <!-- Règle pour les techniciens -->
    <record id="intervention_user_rule" model="ir.rule">
        <field name="name">Règle technicien interventions</field>
        <field name="model_id" ref="model_intervention_intervention"/>
        <field name="domain_force">[('technicien_principal_id.user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_intervention_technicien'))]"/>
    </record>
    <!-- Règle d'accès totale pour les administrateurs et gestionnaires -->
    <record id="intervention_admin_manager_rule" model="ir.rule">
        <field name="name">Accès complet interventions (admin/gestionnaire)</field>
        <field name="model_id" ref="model_intervention_intervention"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_intervention_gestionnaire')), (4, ref('group_intervention_admin'))]"/>
    </record>
</odoo>
